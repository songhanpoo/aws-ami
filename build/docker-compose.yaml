version: "3"
services:
  server:
    ports:
      - "${APP_PORT}:${APP_PORT}"
    image: "ami:${APP_VER}"
    build:
      dockerfile: Dockerfile
      context: ./build
      target: dev
    env_file:
      - .env
    volumes:
      - .:/app
    # depends_on:
    #   - mongo
    #   - redis

  # mongo:
  #   image: "mongo:4.2"
  #   ports:
  #     - "${MONGO_PORT}:${MONGO_PORT}"
  #   env_file:
  #     - .env
  # redis:
  #   image: "redis:rc-alpine3.12"
  #   command: redis-server --requirepass ${REDIS_PWD}
  #   ports:
  #     - "${REDIS_PORT}:${REDIS_PORT}"
  #   env_file:
  #     - .env